<%# OVERVIEW This partial is the procedure for the **Director Config** pane in the BOSH Director. IaaS-specific information is separated with `if` statements. %>

<%# PARTIAL REFERENCES This partial is called in all IaaS-specific BOSH Director configuration topics. %>

To configure the **Director Config** pane:

1. Select **Director Config**.

    ![alt-text=""](../common/images/director-config.png)

<%# **NTP Servers** field, differentiated by IaaS %>

<%# For OpenStack: %>
<% if current_page.data.iaas == "OpenStack" %>
1. Enter one or more NTP servers in the **NTP Servers (comma delimited)** field. For example, `us.pool.ntp.org`.
<% end %>

<%# For GCP: %>
<% if current_page.data.iaas == "GCP" %>
1. In the **NTP Servers (comma delimited)** field, enter `169.254.169.254` to designate the `metadata.google.internal` host as NTP server.
<% end %>

<%# For AWS: %>
<% if current_page.data.iaas == "AWS" %>
1. In the **NTP Servers (comma delimited)** field, enter at least three reachable NTP servers separated by a comma. For example: `0.amazon.pool.ntp.org,1.amazon.pool.ntp.org,2.amazon.pool.ntp.org,3.amazon.pool.ntp.org`

    If your AWS environment is air gapped, consider using [Amazon's Time Sync Service](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/set-time.html#configure-amazon-time-service) which has a dedicated IP that does not require access to the internet or configuration changes to your security group or network ACL rules to access.
<% end %>

<%# For Azure: %>
<% if current_page.data.iaas == "Azure" %>
1. Enter any valid value for **NTP Servers (comma delimited)**. A value is required but is ignored. For example, you can enter `us.pool.ntp.org`. By default, Azure VMs use a Precision Time Protocol (PTP) clock source. For more information, see [Time sync for Linux VMs in Azure](https://docs.microsoft.com/en-us/azure/virtual-machines/linux/time-sync) in the Azure documentation.
<% end %>

<%# For vSphere: %>
<% if current_page.data.iaas == "vSphere" %>
1. Enter one or more NTP servers in the **NTP Servers (comma delimited)** field. For example, `us.pool.ntp.org`.
<% end %>
    1. The NTP server configuration only updates after VM recreation. If you modify the value of this field, select the Recreate VMs deployed by the BOSH Director checkbox to re-create your BOSH Director-deployed VMs and update the NTP server configuration. If you have any service tiles installed, ensure that the Recreate All Service Instances errand runs for each service tile.

1. Leave the **Bosh HM Forwarder IP Address** field blank.
    <p class='note'><strong>Note:</strong> Starting in <%= vars.app_runtime_full_pivotal %> (<%= vars.app_runtime_abbr_pivotal %>) v2.0, BOSH-reported component metrics are available in Loggregator Firehose by default. If you continue to use the BOSH HM Forwarder to consume these component metrics, you might receive duplicate data. To prevent this, leave the <strong>Bosh HM Forwarder IP Address</strong> field blank.</p>

1. Select the **Enable VM Resurrector Plugin** checkbox to enable the BOSH Resurrector functionality and increase your runtime availability. <% if current_page.data.iaas == "vSphere" %>If you intend to install <%= vars.app_runtime_abbr %>, see [Using the BOSH Resurrector](https://docs.pivotal.io/platform/customizing/resurrector.html) for more information about the Resurrector plugin.<% end %>

1. The **Enable BOSH System Metrics Server** checkbox is deprecated, only keep it selected if your metrics system relies upon the format used. It is recommended that you switch away from this format as soon as possible, as this option is going away in future releases.

1. Keep the **Enable System Metrics** checkbox selected to collect system metrics, including load, CPU, memory, swap, and disk metrics, and make them available for scraping from agents on each VM. This is recommended if you are using TAS, as it will scrape the agents automatically and insert the metrics into the regular logging and metrics egress stream. For a list of metrics collected, see [System Metrics Agent](https://github.com/cloudfoundry/system-metrics-release/blob/develop/docs/system-metrics-agent.md) in GitHub.

1. Select **Enable Post Deploy Scripts** to run a post-deploy script after deployment. This script allows the job to execute additional commands against a deployment.
    <p class='note'><strong>Note:</strong> If you intend to install <%= vars.k8s_runtime_first %>, you must enable post-deploy scripts.</p>

2. Select **Enable Short Lived NATS Bootstrap Credentials** to rotate the bootstrap NATS credentials. This feature increases security by [rotating the bootstrap credentials](/docs-ops-manager/security/pcf-infrastructure/rotate-bootstrap-nats-certificates.html) that are used when starting the VMs.
    <p class='note'><strong>Note:</strong> This feature will make the BOSH Agent restart when creating a VM, and will make the creation of a VM moderately slower.</p>

1. Select **Recreate VMs deployed by the BOSH Director** to force BOSH to re-create BOSH-deployed VMs on the next deploy. This process does not re-create the BOSH Director VM or destroy any persistent disk data. This checkbox is cleared automatically after a successful re-deployment.

1. Select **Recreate BOSH Director VMs** to force the BOSH Director VM to be re-created on the next deploy. This process does not destroy any persistent disk data. This checkbox is cleared automatically after a successful re-deployment.

1. Select **Recreate All Persistent Disks** to force BOSH to migrate and re-create persistent disks for the BOSH Director and all tiles. This process does not destroy any persistent disk data. This checkbox is cleared automatically after a successful re-deployment.

1. Select **Enable bosh deploy retries** to instruct <%= vars.ops_manager %> to retry failed BOSH operations up to five times.

1. Select **Skip Director Drain Lifecycle** to prevent drain scripts from running when the BOSH Director is re-created.

1. Select **Store BOSH Job Credentials on tmpfs (beta)** to store credentials for BOSH jobs on temporary file storage (tmpfs) memory, rather than on disk. You must re-create all BOSH-deployed VMs for this setting to take effect.

1. Select **Keep Unreachable Director VMs** to preserve BOSH Director VMs after a failed deployment for troubleshooting purposes.

1. (Optional) Modify the **Director Workers** value, which sets the number of workers available to execute BOSH Director tasks. This field defaults to `5`.

1. (Optional) **Max Threads** sets the maximum number of threads that the BOSH Director can run simultaneously. <%= vars.company_name %> recommends that you leave the field blank to use the default value, unless doing so results in rate limiting or errors on your IaaS.

1. (Optional) To add a custom URL for your BOSH Director, enter a valid hostname in **Director Hostname**. You can also use this field to configure a load balancer in front of your BOSH Director. For more information, see [How to Set Up a Load Balancer in Front of Operations Manager Director](https://community.pivotal.io/s/article/How-to-Set-Up-a-Load-Balancer-in-Front-of-Ops-Manager-Director) in the VMware Tanzu Support knowledge base.

    ![alt-text="There are three text fields, Director Workers, Max Threads, and Director Hostname."](../common/images/director_workers.png)

1. (Optional) To set a custom banner that users see when logging in to the BOSH Director using SSH, enter text in the **Custom SSH Banner** field.

2. <%= partial "../common/identification-tags" %>

3. <%= partial "../common/certificates-config" %>

1. Select **HM Pager Duty Plugin** to enable Health Monitor integration with PagerDuty.<br>

    ![alt-text="There is a selected check box, HM Pager Duty Plugin, and two text fields, Service Key and HTTP Proxy."](../common/images/director_hm_pager.png)

    * **Service Key**: Enter your API service key from PagerDuty.
    * **HTTP Proxy**: Enter an HTTP proxy for use with PagerDuty.

1. Select **HM Email Plugin** to enable Health Monitor integration with email.

    ![alt-text="There is a selected check box, HM Email Plugin, and seven text fields: Host, Port, Domain, From, Recipients, Username, and Password."](../common/images/director_hm_email.png)

    * **Host**: Enter your email hostname.
    * **Port**: Enter your email port number.
    * **Domain**: Enter your domain.
    * **From**: Enter the address for the sender.
    * **Recipients**: Enter comma-separated addresses of intended recipients.
    * **Username**: Enter the username for your email server.
    * **Password**: Enter the password for your email server.
    * **Enable TLS**: Select this checkbox to enable Transport Layer Security to the email host.

<%= partial "../common/credhub-encryption" %>

<%= partial "../common/blobstore-location" %>

<%= partial "../common/director-database-location" %>

1.  Click **Save**.
